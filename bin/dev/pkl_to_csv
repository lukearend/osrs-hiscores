#!/usr/bin/env python3

""" Export player stats, cluster IDs, or cluster centroids to CSV. """

import argparse

from src.analysis.data import load_pkl, export_players_csv, export_clusterids_csv, export_centroids_csv

parser = argparse.ArgumentParser(description="Convert .pkl file to CSV.")
parser.add_argument('--in-file', required=True, help=".pkl file to convert")
parser.add_argument('--out-file', required=True, help="resulting CSV file")
parser.add_argument('--type', required=True, choices=['centroids', 'clusterids', 'players'], help="conversion type")
args = parser.parse_args()

print(f"loading {args.in_file}...")
in_obj = load_pkl(args.in_file)

print(f"exporting to {args.out_file}...")
if args.type == 'centroids':
    export_centroids_csv(in_obj, args.out_file)
elif args.type == 'clusterids':
    export_clusterids_csv(in_obj, args.out_file)
elif args.type == 'players':
    export_players_csv(in_obj, args.out_file)
else:
    raise ValueError(f"unrecognized conversion type: '{args.type}'")

print("done")

#!/usr/bin/env python

""" Export final data to CSV (player stats, cluster IDs, and cluster centroids). """

import argparse

from src.analysis.data import load_pkl, export_players_csv, export_clusterids_csv, export_centroids_csv


parser = argparse.ArgumentParser(description="Export final dataset .""")
parser.add_argument('in_pkl', help=".pkl file to convert to CSV")
parser.add_argument('out_csv', help="write converted output to this CSV file")
parser.add_argument('--type', required=True, choices=['centroids', 'clusterids', 'players'],
                    help="type of conversion to apply")
args = parser.parse_args()


contents, export_fn = {
    'centroids': ('cluster centroids', export_centroids_csv),
    'clusterids': ('player cluster IDs', export_clusterids_csv),
    'players': ('player stats', export_players_csv)
}[args.type]


print(f"exporting {contents} to {args.out_csv}...")
in_obj = load_pkl(args.in_pkl)
export_fn(in_obj, args.out_csv)

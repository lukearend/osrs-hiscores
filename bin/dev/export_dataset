#!/usr/bin/env python

""" Export final data to CSV (player stats, cluster IDs, and cluster centroids). """

import argparse

from src.analysis.data import load_pkl, export_players_csv, export_clusterids_csv, export_centroids_csv


parser = argparse.ArgumentParser(description="Export final dataset .""")
parser.add_argument('stats_pkl', type=str, help="player stats .pkl file")
parser.add_argument('stats_csv', type=str, help="write stats dataset to this CSV file")
parser.add_argument('clusterids_pkl', type=str, help="player cluster IDs .pkl file")
parser.add_argument('clusterids_csv', type=str, help="write player cluster IDs to this CSV file")
parser.add_argument('centroids_pkl', type=str, help="cluster centroids .pkl file")
parser.add_argument('centroids_csv', type=str, help="write cluster centroids to this CSV file")
args = parser.parse_args()


print("exporting cluster centroids...")
cluster_centroids = load_pkl(args.centroids_pkl)
export_centroids_csv(cluster_centroids, args.centroids_csv)

print("exporting player cluster IDs...")
player_clusterids = load_pkl(args.clusterids_pkl)
export_clusterids_csv(player_clusterids, args.clusterids_csv)

print("exporting player stats...")
player_stats = load_pkl(args.stats_pkl)
export_players_csv(player_stats, args.stats_csv)
print("done")

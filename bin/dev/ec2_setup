#!/usr/bin/env bash

if ! [ -f ~/.ssh/id_ed25519 ]; then
  ssh-keygen -t ed25519 -f ~/.ssh/id_ed25519 -C osrs-hiscores-ec2-instance -q -N ""
  echo "Generated SSH pair. Public key:"
  cat ~/.ssh/id_ed25519.pub
  exit 0
fi

sudo yum upgrade -y
sudo yum install git docker -y

sudo usermod -aG docker ec2-user
newgrp docker

sudo service docker start
docker run hello-world

sudo amazon-linux-extras install epel -y
sudo yum install openvpn -y

sudo git pull git@github.com:lukearend/osrs-hiscores.git
cd osrs-hiscores && git checkout development && make init

#!/usr/bin/env python3

""" Download scraping and clustering results data. """

import argparse
import os

from src.analysis.data import download_s3_obj


parser = argparse.ArgumentParser(description="Download pre-computed scraping and clustering results.")
parser.add_argument('s3_bucket', help="download files from this S3 bucket")
parser.add_argument('stats_file', help="write player stats to this file")
parser.add_argument('clusterids_file', help="write player cluster IDs to this file")
parser.add_argument('centroids_file', help="write cluster centroids to this file")
args = parser.parse_args()


s3_keys = {
    args.stats_file: 'stats.pkl',
    args.clusterids_file: 'clusterids.pkl',
    args.centroids_file: 'centroids.pkl'
}
for file in [args.stats_file, args.clusterids_file, args.centroids_file]:
    if os.path.exists(file):
        print(f"{file} already exists, skipping download")
        continue

    with open(file, 'wb') as f:
        f.write(download_s3_obj(args.s3_bucket, s3_keys[file]))

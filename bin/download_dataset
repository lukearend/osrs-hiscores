#!/usr/bin/env python3
import os
from pathlib import Path
from dotenv import find_dotenv, load_dotenv
from src.common import env_var, download_from_s3

centroids_file = Path(__name__).resolve().parents[1] / "data" / "processed" / "cluster-centroids.csv"
clusters_file = Path(__name__).resolve().parents[1] / "data" / "processed" / "player-clusters.csv"
stats_file = Path(__name__).resolve().parents[1] / "data" / "processed" / "player-stats.csv"

load_dotenv(find_dotenv())
bucket = env_var("OSRS_DATASET_S3BUCKET")
if not os.path.exists(centroids_file):
    download_from_s3(bucket, "cluster-centroids.csv", str(centroids_file))
if not os.path.exists(clusters_file):
    download_from_s3(bucket, "player-clusters.csv", str(clusters_file))
if not os.path.exists(stats_file):
    download_from_s3(bucket, "player-stats.csv", str(stats_file))

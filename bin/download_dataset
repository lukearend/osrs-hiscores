#!/usr/bin/env python3
from pathlib import Path
from src.common import env_var, download_from_s3
from dotenv import find_dotenv, load_dotenv

centroids_file = Path(__name__).resolve().parents[1] / "data" / "processed" / "cluster-centroids.csv"
clusters_file = Path(__name__).resolve().parents[1] / "data" / "processed" / "player-clusters.csv"
stats_file = Path(__name__).resolve().parents[1] / "data" / "processed" / "player-stats.csv"

load_dotenv(find_dotenv())
bucket = env_var("OSRS_DATASET_S3BUCKET")
download_from_s3(bucket, "cluster-centroids.csv", str(centroids_file))
download_from_s3(bucket, "player-clusters.csv", str(clusters_file))
download_from_s3(bucket, "player-stats.csv", str(stats_file))

#!/usr/bin/env python3
"""
todo:
this script should use argparse and take in the namnes of files to download as command line arguments
when run with no arguments or help, -h or --help, it should print the help text.
"""
import os
from pathlib import Path
from dotenv import find_dotenv, load_dotenv
from src import env_var
from src.analytics.data import download_from_s3

centroids_file = Path(__name__).resolve().parents[1] / "data" / "processed" / "cluster-centroids.csv"
clusters_file = Path(__name__).resolve().parents[1] / "data" / "processed" / "player-clusters.csv"
stats_file = Path(__name__).resolve().parents[1] / "data" / "processed" / "player-stats.csv"

def lazy_download(bucket, key, file):
    if os.path.exists(file):
        print(f"{file} already exists")
    else:
        download_from_s3(bucket, key, str(file))

load_dotenv(find_dotenv())
bucket = env_var("OSRS_DATASET_BUCKET")
lazy_download(bucket, "cluster-centroids.csv", str(centroids_file))
lazy_download(bucket, "player-clusters.csv", str(clusters_file))
lazy_download(bucket, "player-stats.csv", str(stats_file))





